import{h as f,i as h,e as x,r as n,j as s,s as o}from"./index-CdJipTJO.js";function _(){const{uid:t}=f();h();const a=x(),[c,r]=n.useState(null),[g,i]=n.useState(!0);return n.useEffect(()=>{async function u(){var l,d;if(!t){r("Keine UID gefunden"),i(!1);return}const{data:e,error:m}=await o.from("chips").select("*, company:companies(*), assigned_user:users(*)").eq("uid",t).single();if(m||!e){r("Chip nicht erkannt"),i(!1);return}try{await o.from("scans").insert({chip_id:e.id,scanned_at:new Date().toISOString()})}catch(p){console.error("Failed to log scan",p)}switch(e.active_mode){case"corporate":case"vcard":(l=e.assigned_user)!=null&&l.slug?a(`/p/${e.assigned_user.slug}`,{replace:!0}):e.assigned_user_id&&a(`/p/${e.assigned_user_id}`,{replace:!0});break;case"hospitality":case"menu":(d=e.menu_data)!=null&&d.url?window.location.href=e.menu_data.url:a(`/review/${e.company_id}`,{replace:!0});break;case"campaign":a(`/campaign/${e.company_id}`,{replace:!0});break;case"redirect":e.target_url&&(window.location.href=e.target_url);break;default:r("Unbekannter Modus"),i(!1)}}u()},[t,a]),c?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-4 text-center",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold mb-2 text-red-500",children:c}),s.jsx("p",{className:"text-zinc-400",children:"Dieser NFC-Tag ist nicht registriert oder inaktiv."}),s.jsxs("p",{className:"mt-4 text-xs text-zinc-600",children:["UID: ",t]})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-zinc-400",children:"LÃ¤dt..."})]})})}export{_ as default};
