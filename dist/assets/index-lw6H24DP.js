import{c as p,u as k,r as i,j as e,U as S,L as C,s as c}from"./index-CdJipTJO.js";import{C as u}from"./card-CM9SCnqF.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],q=p("arrow-up-right",M);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],L=p("dollar-sign",D);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],j=p("scan-line",A);function r({title:t,value:o,change:x,icon:l}){return e.jsxs(u,{className:"bg-zinc-900 border-white/5 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-400",children:t}),e.jsx("h2",{className:"text-2xl font-bold mt-2",children:o})]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center text-zinc-400",children:e.jsx(l,{size:20})})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-4",children:x})]})}function E(){const{user:t}=k(),[o,x]=i.useState(!0),[l,g]=i.useState(0),[b,v]=i.useState(0),[N,y]=i.useState(0),[f,w]=i.useState([]);return i.useEffect(()=>{async function s(){if(!t)return;const{data:a}=await c.from("users").select("id, company_id").eq("id",t.id).single();let n=c.from("chips").select("id");a!=null&&a.company_id?n=n.eq("company_id",a.company_id):n=n.eq("assigned_user_id",t.id);const{data:h}=await n,d=(h==null?void 0:h.map(m=>m.id))||[];if(y(d.length),d.length>0){const[m,z]=await Promise.all([c.from("scans").select("*",{count:"exact",head:!0}).in("chip_id",d),c.from("scans").select("*").in("chip_id",d).order("scanned_at",{ascending:!1}).limit(5)]);g(m.count||0),w(z.data||[])}const{count:_}=await c.from("leads").select("*",{count:"exact",head:!0}).eq("captured_by_user_id",t.id);v(_||0),x(!1)}s()},[t]),o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-sm text-zinc-400",children:"System Online"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(r,{title:"Gesamt Scans",value:l,change:"Gesamtzeit",icon:j}),e.jsx(r,{title:"Aktive Kontakte",value:b,change:"Erfasste Kontakte",icon:S}),e.jsx(r,{title:"Aktive Chips",value:N,change:"Verteilte Geräte",icon:q}),e.jsx(r,{title:"Umsatz",value:"0€",change:"Platzhalter",icon:L})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(u,{className:"bg-zinc-900 border-white/5 p-6 h-[400px]",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Live Scan Feed"}),e.jsx("div",{className:"text-zinc-500 text-sm",children:e.jsxs("div",{className:"space-y-4 mt-4",children:[f.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between border-b border-white/5 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400",children:e.jsx(j,{size:14})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.device_type||"Unknown Device"}),e.jsx("p",{className:"text-xs text-zinc-500",children:new Date(s.scanned_at).toLocaleTimeString()})]})]}),e.jsx("span",{className:"text-xs text-zinc-600",children:s.ip_address})]},s.id)),!f.length&&e.jsx("p",{children:"Noch keine Scans."})]})})]}),e.jsxs(u,{className:"bg-zinc-900 border-white/5 p-6 h-[400px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Performance (30 Tage)"}),e.jsx(C,{to:"/dashboard/analytics",className:"text-xs text-blue-400 hover:underline",children:"Details"})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center flex-col gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-4xl font-bold text-white mb-1",children:l}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"Scans Gesamt"})]}),e.jsx("div",{className:"w-full bg-white/5 h-32 rounded-lg flex items-end px-4 gap-2 pb-2",children:[40,60,30,80,50,90,70].map((s,a)=>e.jsx("div",{className:"flex-1 bg-blue-500/20 rounded-t-sm hover:bg-blue-500/50 transition-all",style:{height:`${s}%`}},a))}),e.jsx("p",{className:"text-xs text-zinc-600",children:"Mini-Preview. Für Details siehe Analytics."})]})]})]})]})}export{E as default};
