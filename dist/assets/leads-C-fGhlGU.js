import{c as u,u as N,r as l,j as e,s as y}from"./index-CdJipTJO.js";import{B as x}from"./button-DuQyEyRp.js";import{T as k,a as _,b as d,c as r,d as L,e as n,B as S}from"./table-Iy6iH93X.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],C=u("download",M);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],R=u("refresh-cw",E);function B(){const{user:i}=N(),[j,b]=l.useState(!0),[c,f]=l.useState([]);l.useEffect(()=>{async function s(){if(!i)return;const{data:a}=await y.from("leads").select("*, users(name)").eq("captured_by_user_id",i.id).order("created_at",{ascending:!1});f(a||[]),b(!1)}s()},[i]);function p(){if(!c.length)return;const s=["Name","Email","Stimmung","Erfasst von","Datum"],a=c.map(t=>{var h;return[t.lead_name,t.lead_email,t.sentiment,((h=t.users)==null?void 0:h.name)||"-",new Date(t.created_at).toLocaleDateString()]}),g=[s.join(","),...a.map(t=>t.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(v),o=document.createElement("a");o.href=m,o.download=`leads_${new Date().toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(m)}function w(){alert("CRM-Sync kommt bald!")}return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Kontakte"}),e.jsx("p",{className:"text-zinc-500",children:"Erfasste Kontakte aus dem Visitenkarten-Modus."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",className:"border-white/10",onClick:p,children:[e.jsx(C,{size:16,className:"mr-2"})," Export CSV"]}),e.jsxs(x,{variant:"outline",className:"border-white/10",onClick:w,children:[e.jsx(R,{size:16,className:"mr-2"})," CRM Sync"]})]})]}),e.jsx("div",{className:"rounded-md border border-white/5 bg-zinc-900/50",children:e.jsxs(k,{children:[e.jsx(_,{children:e.jsxs(d,{className:"border-white/5 hover:bg-white/5",children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"E-Mail"}),e.jsx(r,{children:"Stimmung"}),e.jsx(r,{children:"Erfasst von"}),e.jsx(r,{children:"Datum"})]})}),e.jsxs(L,{children:[c.map(s=>{var a;return e.jsxs(d,{className:"border-white/5 hover:bg-white/5",children:[e.jsx(n,{className:"font-medium text-white",children:s.lead_name}),e.jsx(n,{className:"text-zinc-400",children:s.lead_email}),e.jsx(n,{children:e.jsx(S,{variant:"outline",className:s.sentiment==="hot"?"border-green-500 text-green-400 bg-green-500/10":s.sentiment==="warm"?"border-yellow-500 text-yellow-400 bg-yellow-500/10":"border-red-500 text-red-400 bg-red-500/10",children:s.sentiment})}),e.jsx(n,{className:"text-zinc-400",children:((a=s.users)==null?void 0:a.name)||"-"}),e.jsx(n,{className:"text-zinc-500",children:new Date(s.created_at).toLocaleDateString()})]},s.id)}),c.length===0&&e.jsx(d,{children:e.jsx(n,{colSpan:5,className:"text-center py-10 text-zinc-500",children:"Noch keine Kontakte erfasst."})})]})]})})]})}export{B as default};
